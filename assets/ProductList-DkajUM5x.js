import{r as n,u as m,j as s,L as d,a as h,b as f}from"./index-CV5F6aYR.js";import{f as x}from"./productsApi-DxbXHi7U.js";import{P as j}from"./index-DJYKvmir.js";import{f as p}from"./formatCurrency-A_zjcONg.js";function g(){const[e,c]=n.useState([]),[a,i]=n.useState(!0),[o,r]=n.useState(null);return n.useEffect(()=>{let t=!0;return(async()=>{i(!0);try{const l=await x();t&&c(l)}catch(l){t&&r(l.message||"Unknown error")}finally{t&&i(!1)}})(),()=>{t=!1}},[]),{products:e,loading:a,error:o}}function u({product:e}){const c=m(),a=()=>{const i={id:e.id,title:e.title,price:e.price,thumbnail:e.thumbnail||e.images&&e.images[0]||""};c(h(i))};return s.jsxs("article",{className:"card",children:[s.jsx(d,{to:`/product/${e.id}`,children:s.jsx("img",{src:e.thumbnail||e.images&&e.images[0],alt:e.title,loading:"lazy"})}),s.jsxs("div",{className:"card-body",children:[s.jsx("h3",{children:e.title}),s.jsx("p",{className:"price",children:p(e.price)})," ",s.jsxs("div",{className:"actions",children:[s.jsx("button",{onClick:a,children:"Add to cart"}),s.jsx(d,{to:`/product/${e.id}`,className:"detail-link",children:"Details"})]})]})]})}u.propTypes={product:j.object.isRequired};function b(){const{products:e,loading:c,error:a}=g(),i=f(r=>r.cart.searchQuery||""),o=n.useMemo(()=>{if(!i)return e;const r=i.toLowerCase();return e.filter(t=>t.title&&t.title.toLowerCase().includes(r)||t.description&&t.description.toLowerCase().includes(r))},[e,i]);return c?s.jsx("div",{className:"center",children:"Loading products..."}):a?s.jsxs("div",{className:"center error",children:["Error: ",a]}):s.jsxs("section",{children:[s.jsxs("div",{className:"products-header",children:[s.jsx("h2",{children:"Products"}),s.jsxs("small",{children:[o.length," results"]})]}),s.jsx("div",{className:"grid",children:o.map(r=>s.jsx(u,{product:r},r.id))})]})}export{b as default};
