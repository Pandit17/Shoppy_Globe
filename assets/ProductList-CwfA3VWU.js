import{r as c,u as o,j as s,L as u,a as m,y as h,b as f}from"./index-BRkf0ifn.js";import{f as x}from"./productsApi-DxbXHi7U.js";import{f as j}from"./formatCurrency-A_zjcONg.js";function g(){const[e,n]=c.useState([]),[i,a]=c.useState(!0),[l,t]=c.useState(null);return c.useEffect(()=>{let r=!0;return(async()=>{a(!0);try{const d=await x();r&&n(d)}catch(d){r&&t(d.message||"Unknown error")}finally{r&&a(!1)}})(),()=>{r=!1}},[]),{products:e,loading:i,error:l}}function N({product:e}){const n=o(),i=()=>{if(!e?.id)return;const a={id:e.id,title:e.title,price:e.price,thumbnail:e.thumbnail||e.images&&e.images[0]||""};n(m(a)),h.success(`${e.title} added to cart!`)};return s.jsxs("div",{className:"card",children:[s.jsx("img",{src:e.thumbnail||e.images&&e.images[0],alt:e.title}),s.jsxs("div",{className:"card-body",children:[s.jsx("h3",{children:e.title}),s.jsx("p",{className:"price",children:j(e.price)}),s.jsxs("div",{className:"actions",children:[s.jsx(u,{to:`/product/${e.id}`,className:"detail-link",children:"Details"}),s.jsx("button",{onClick:i,className:"add-cart-btn",children:"Add to Cart"})]})]})]})}function b(){const{products:e,loading:n,error:i}=g(),a=f(t=>t.cart.searchQuery||""),l=c.useMemo(()=>{if(!a)return e;const t=a.toLowerCase();return e.filter(r=>r.title&&r.title.toLowerCase().includes(t)||r.description&&r.description.toLowerCase().includes(t))},[e,a]);return n?s.jsx("div",{className:"center",children:"Loading products..."}):i?s.jsxs("div",{className:"center error",children:["Error: ",i]}):s.jsxs("section",{children:[s.jsxs("div",{className:"products-header",children:[s.jsx("h2",{children:"Products"}),s.jsxs("small",{children:[l.length," results"]})]}),s.jsx("div",{className:"grid",children:l.map(t=>s.jsx(N,{product:t},t.id))})]})}export{b as default};
